332018-07-12
    find CBECC-Res draw pattern files

/home/jiml/.PlayOnLinux/wineprefix/CBECC_Res19/drive_c/Program Files (x86)/CBECC-Res 2019/CSE/DHWDUSF.txt

    set up new R project
    
    think I got git working for it. No version control in RStudio though
    
    trying grep 365 day DHW Profile by number of Bedrooms, after read_file it's a single char vector
    better to use stringr functions
    
    https://www.r-bloggers.com/basic-text-string-functions-in-r/
    
2018-07-13

    See CSE User's Manual, California Simulation Engine    
    https://cse-sim.github.io/cse/cse-user-manual/introduction.html#introduction
    
    can use wineconsole to open a DOS window that CSE19.exe runs in
    
    copied a sample file from '/home/jiml/Documents/CBECC-Res 2019 Projects/Samples/'
    it ran, read the input file. choked cause 
        RulesetFilename   "CA Res 2019.bin"  
    encouraging
    
    created a ExampleFile that runs with CSE errors.        
        
2018-07-16
    try CSE some more
    make wineconsole of CSE19.exe still works
    
    $ wineconsole
    err:winedevice:ServiceMain driver L"WineBus" failed to load
    fixme:console:CONSOLE_DefaultHandler Terminating process 31 on event 0

    oops, try uninstalling  wine and playonlinux ?
    
    wineconsole still works
    
    $ apt list --installed | grep wine
        wine1.8/xenial,now 1:1.8.0-0ubuntu1~ubuntu15.10.1~ppa1 amd64 [installed,auto-removable]
        wine1.8-amd64/xenial,now 1:1.8.0-0ubuntu1~ubuntu15.10.1~ppa1 amd64 [installed,auto-removable]
        wine1.8-i386/xenial,now 1:1.8.0-0ubuntu1~ubuntu15.10.1~ppa1 i386 [installed,auto-removable]
    $ apt list --installed | grep playonlinux
    $ apt list  | grep playonlinux
        playonlinux/xenial-updates,xenial-updates 4.2.10-2ubuntu0.1 all

    so wine is still installed, but playonlinux isn't
    
    wineconsole still works
    figured out how to run CSE19 and get reports.
    still need to figure out how to put data in reports
    probably best to use this to report hourly Tinlet
    
    Go back to R to get draw info
        end use
        start time
        duration
   We can set total flow rates as we choose
   or maybe extract from DHWDUSF.txt without temperature calculations
   
2018-07-17

    U0022: DHWSys 'DHW1' member tInlet has not been set yet.
    
    had to set EXPORTCOLs
    
    got Tinlet for CTZ12
    figure out how to repeat for all the CTZs
        
    made a bash script (writeRUNALL.sh) to make 
    a CSE input file (RUNALL.tst) th
    at includes all CTZs
    that called in include files (DHWDUSF.txt, coreinputfile.txt ) altered input for CTZs
    in wineconsole 
        CSE19 RUNALL.tst
        
    seemed to work
        
2018-07-20

    more detailed draw patterns not in *.rep file
    see if any probes for DHW in CSE manual
    
    was able to get names of DHWDayUse, but couldn't figure out how to get DHWUse
    go back using R to read DHWDUST.txt
    
2018-07-25
        
    DHW Profiles from DHWDUSF.txt
    
    got the DWHProfiles, turned into data.table and saved

    good start on getting DHWDAYUSEs, probably list of named lists instead of a data.table


2018-07-28
    from CSE Users Manual
    DHWDAYUSE
    Defines an object that represents domestic hot water use for a single day. A DHWDAYUSE contains a 
    collection of DHWUSE objects that specify the time, volume, and duration of individual draws.

    think I have DHWDAYUSEs as a list of 48 lists of DHWUSEs
    turn it into a data.table of DHWUSEs with an added field of which DHWDAYUSE it belongs to

    got DT_DHWUSEs but saved it under wrong name, overwrote previous data set

    rerun read_DHWDUSF.R to rebuild the overwritten data sets
    pick "3D4", 3 bedroom, weekday to send to Yanda & Gary,

    build data.table of 365 day DHW Profiles to DHWUSEs and of CZ inlet water  
    then can pick days that are high and low use water and draws.
    think about how to rate clusteriness and dispersion. curve of time between draws?
    
    will also want to do distributions of FAUC durations to figure out what to do about
    clearing and fauceting draws.
    
    the DHWDAYUSEs are sorted alphabetically in DHWDUSF.txt!
    
    used table and sink to get a count of enduses per DHWDAYUSE

2018-08-03
    summary by day, date, WEH, # bedroooms, # people, # draws, total (mixed) volume, sum draws by type, inlet water temp
    
    made DT_total_drawpatterns
    
    something isn't working for datetime
    
    I'm having problems avoiding the timechanges 
    
2018-08-04
    read Tinlet into a data table of:
        dayOfYear   1:365
        TinletCTZ01 degF
        ....
        TinletCTZ16 degF
    files are in '/home/jiml/HotWaterResearch/projects/How Low/draw_patterns/CSE/TINLET/'
    
    hourly Tinlet was calculated independently of time changes, was getting way too many
    even with that fixed Tinlet isn't as smooth as expected
    maybe being overly influenced by Tair?
    
2018-08-05
    ignore bumpy Tinlet for now
    just get a wide Tinlet data.table

    4H1 is 4 people Holiday 1 
    
    hand assemble an daily_draws.xlsx file from DT_daily{1:5}.csv
    
2018-08-06
    start building input for Yanda's spreadsheet model
    fields:
        Event Index             1:length*2, includes the 'No use, cool down' Event Types
            do this after all the others created
        Start Time              date & start in a d/m/yyyy h:m:s format
        Fixture ID              B2_SK1,B3_SK, K_SK, LN_WA, MB_SH, MB_SK1, MB_SK2, etc
            unlocated enduses at this time
        Event Type              'Use', 'No use, cool down'
        Wait for Hot Water?     Yes, (for shower, bath, & long 'first' kitchen sink), No (everything else)	         	
        Include Behavior Wait?  Yes for shower & bath, No for everything else.
        Behavior Wait Trigger   5 for showers & baths, blank if 'Include Behavior Wait?' is No  (sec)	
the following still need to be added
        Behavior wait           45 for showers & baths, blank if 'Include Behavior Wait?' is No  (sec)(sec)	
        Use time                duration (sec)	        
        Flow rate - waiting     kitchen faucet is 1.8, tub/shower combo is 4, master bath tubspout is 6 (GPM)	
        Flow rate - use         bathroom faucet max is 1.2, kitchen faucet max is 1.8(GPM)	
        Hot Water Temp          125 (F)	
        Threshold Temp          105 (F)	
        Ambient Temp            70 (F)

    use 3D1, 3H1 for now.
    
2018-08-07
    output enduse, leave Fixture.ID blank for manual assignment
    refactor to keep DT_total_drawpatterns columns, add all new ones instead of renaming any
    if I can figure out how to highlight Excel cells, highlight possible faucet draws with clearing draw
    and use Yanda's variable names
    